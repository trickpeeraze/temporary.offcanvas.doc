(function(e){e.fn.offcanvas=function(t,n){function d(e){t.onBeforeOpen.call(h);if(this.isClose){if(t.pushAndPull){h.siblings().transition(a.on,t.duration,t.easing)}if(u)p.show();h.transition(a.on,t.duration,t.easing,function(){t.onOpen.call(h);if(typeof e==="function")e.call(h)});this.isOpen=true;this.isClose=false}}function v(e){t.onBeforeClose.call(h);if(this.isOpen){if(t.pushAndPull){h.siblings().transition(a.off,t.duration,t.easing)}if(u)p.hide();h.transition(a.off,t.duration,t.easing,function(){t.onClose.call(h);if(typeof e==="function")e.call(h)});this.isOpen=false;this.isClose=true}}function m(){h.remove()}function g(e){return/%$/.test(e)?i.outerWidth()*parseInt(e)/100:parseInt(e)}function y(){var e={position:"fixed",padding:t.canvasPadding,boxSizing:"border-box",MozBoxSizing:"border-box",webkitBoxSizing:"border-box",overflow:"auto"};if(!t.fixedPosition){i.css("overflow","hidden");e.position="absolute"}switch(t.position){case"top":e.top=-f;e.height=f;e.left=0;e.width="100%";a={on:{y:f+l},off:{y:0}};break;case"bottom":e.bottom=-f;e.height=f;e.left=0;e.width="100%";a={on:{y:-(f+l)},off:{y:0}};break;case"left":e.top=0;e.height="100%";e.left=-f;e.width=f;a={on:{x:f+l},off:{x:0}};break;case"right":e.top=0;e.height="100%";e.right=-f;e.width=f;a={on:{x:-(f+l)},off:{x:0}};break}return e}var r={debug:false,content:"",size:0,position:"right",canvasClass:"temp-canvas-wrapper",canvasPadding:"15px",offset:0,duration:220,easing:"linear",toggleButton:"",fixedPosition:true,pushAndPull:false,tapToClose:false,swipeToClose:false,onBeforeOpen:function(){},onOpen:function(){},onBeforeClose:function(){},onClose:function(){}},t=e.extend({},r,t),i=this,s=false,o=true,u=false,a={},f=g(t.size),l=g(t.offset),c=y();var h=e("<div>").addClass(t.canvasClass).css(c);if(t.content instanceof jQuery)t.content.appendTo(h);else h.html(t.content);if(i.css("position")==="static")i.css("position","relative");i.append(h);if(t.tapToClose||t.swipeToClose){u=true;var p=e("<div>",{"class":"canvas-overlay",css:{width:"100%",height:"100%",position:"fixed",top:0,cursor:"pointer"}}).hide();if(!t.fixedPosition){p.css("position","absolute")}h.before(p);if(t.tapToClose){p.on("click",function(){v.call(i)})}if(t.swipeToClose){p[0].addEventListener("touchstart",function(e){var t=e.changedTouches[0];dist={x:0,y:0};startX=t.pageX;startY=t.pageY;e.preventDefault()},false);p[0].addEventListener("touchmove",function(e){e.preventDefault()},false);p[0].addEventListener("touchend",function(e){var n=e.changedTouches[0];var r=110;dist.x=n.pageX-startX;dist.y=n.pageY-startY;switch(t.position){case"left":if(dist.x>0&&dist.y<r&&dist.y>-r){v()}break;case"up":if(dist.y>0&&dist.x<r&&dist.x>-r){v()}break;case"right":if(dist.x<0&&dist.y<r&&dist.y>-r){v()}break;case"down":if(dist.y<0&&dist.x<r&&dist.x>-r){v()}break}e.preventDefault()},false)}}if(typeof n==="function")n(h);this.open=d;this.close=v;this.isOpen=false;this.isClose=true;this.destroy=m;if(t.toggleButton instanceof jQuery){t.toggleButton.on("click",function(t){if(i.isClose){e(this).addClass("active");i.open()}else{e(this).removeClass("active");i.close()}return false})}return this}})(jQuery)